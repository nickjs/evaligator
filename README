The code is pretty terrible. Don't look at the code.
