<html>
<head>
  <title>Code Monster Thing</title>
  <style>
  * {
    padding: 0;
    margin: 0;
  }
  #editor {
    width: 100%;
    height: 100%;
    left: 0;
    display: block;
    position: absolute;
    /*background-color: red;*/
  }
  #visualismifier {
    width: 50%;
    height: 100%;
    right: 0;
    display: block;
    position: absolute;
    background-color: green;
  }
</style>
</head>
<body>
  <div id="editor"></div>
  <!-- <div id="visualismifier"></div> -->
  <script src="ace/ace.js" type="text/javascript"></script>
  <script src="ace/theme-monokai-uncompressed.js" type="text/javascript"></script>
  <script src="lib/parser.js" type="text/javascript"></script>
  <script src="lib/coffee-script.js" type="text/javascript"></script>
  <script src="tentacleporn.coffee" type="text/coffeescript"></script>

  <script type="text/coffeescript">
    class EditorView
      EditSession = require('ace/edit_session').EditSession
      UndoManager = require('ace/undomanager').UndoManager
      Split = require('ace/split').Split
      Mode = require('ace/mode/javascript').Mode

      constructor: (node) ->
        @split = new Split node, require('ace/theme/monokai'), 2

        workerlessMode = new Mode
        workerlessMode.createWorker = ->

        @split.getEditor(0).getSession().setMode new Mode
        @split.getEditor(1).getSession().setMode workerlessMode
        @split.getEditor(1).setReadOnly yes

        @editor = @split.getEditor(0)
        @editor.focus()

        window.addEventListener 'resize', =>
          @split.resize()

        @editor.getSession().on 'change', =>
          theHopefullyNotArbitraryTextThatWasTyped = @editor.getSession().getDocument().getValue()

          codeParser = new SourceCodeParser
          codeParser.parseThemSourceCodes theHopefullyNotArbitraryTextThatWasTyped

          @split.getEditor(1).getSession().setValue codeParser.displayValue()

    window.Editor = new EditorView document.getElementById('editor')
</script>

</body>
</html>
